{% extends 'library/base.html' %}

{% block title %}Детали книги{% endblock %}

{% block content %}

{% include 'library/header.html' %}

<nav>
	<div class="d-grid gap-2 d-md-block">
		<a href="{% url 'library:book_create' %}" class="btn btn-outline-primary mb-0">Добавить новую книгу</a>
	</div>
</nav>

<div class="container mt-5">
	<h1 class="mb-4">{{ book.title }}</h1>
	<p>Дата публикации: {{book.publication_date|date:"d M Y"}}</p>
	<p>Средний рейтинг: {{ average_rating }}</p>
	<p>Популярная: {{ is_popular|yesno:"Да,Нет" }}</p>


	<p>Автор: <a href="{% url 'library:author_detail' book.author_id %}">{{book.author}}</a></p>
	<p>Количество книг автора в библиотеке: {{ author_books_count }}</p>

	<a href="{% url 'library:book_update' book.pk %}" class="btn btn-primary">Редактировать</a>
	<a href="{% url 'library:book_delete' book.pk %}" class="btn btn-danger">Удалить</a>
	<a class="btn btn-secondary" href="{{ request.META.HTTP_REFERER |default:'library/book_list' }}">Назад</a>
</div>

{% if perms.library.can_review_book %}
	<form method="post" action="{% url 'library:book_review' book.pk %}">
		{% csrf_token %}
		<textarea class="form-control w-25 mt-2" name="review" placeholder="Напишите отзыв"></textarea>
		<button class="btn btn-success mt-2" type="submit">Рецензировать</button>
	</form>
{% endif %}
<br>
{% if perms.library.can_recommend_book %}
	<form method="post" action="{% url 'library:book_recommend' book.pk %}">
		{% csrf_token %}
		<button class="btn btn-success" type="submit">Рекомендовать</button>
	</form>
{% endif %}

{% endblock %}
